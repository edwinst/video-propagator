\documentclass{beamer}

\usetheme{Berlin}

\usepackage{braket}

\newcommand{\sqrtpm}{\sqrt{p^2 + m^2}}
\newcommand{\envelope}{\frac{p}{\sqrtpm}}
\newcommand{\integrand}{\frac{p e^{ipr}}{\sqrt{p^2 + m^2}}}
\newcommand{\CC}{\mathbb{C}}

\newcommand{\vp}{\mathbf{p}}
\newcommand{\vx}{\mathbf{x}}
\newcommand{\vy}{\mathbf{y}}
\newcommand{\vr}{\mathbf{r}}
\newcommand{\vpp}{\mathbf{p}'}
\newcommand{\omp}{\omega_{p}}
\newcommand{\omvp}{\omega_{\vp}}
\newcommand{\ap}{a_{\vp}}
\newcommand{\adp}{a^\dagger_{\vp}}
\newcommand{\adpp}{a^\dagger_{\vpp}}
\newcommand{\intpthree}{\int \frac{d^3\vp}{(2\pi)^3}}
\newcommand{\com}[2]{[{#1},{#2}]}
\newcommand{\phixy}{\Braket{0|\phi(x)\phi(y)|0}}
\newcommand{\intii}{\int_{-\infty}^{+\infty}}

\title{Contour integral of free field propagator}
\author{Edwin Steiner}
\date{\today}
% XXX add git hash


\begin{document}


\begin{frame}
\titlepage
\end{frame}


\begin{frame}
For a free massive scalar field

\pause
$$\phi(x) = \intpthree \frac{1}{\sqrt{2\omvp}} \left\{ e^{-ipx} \ap + e^{ipx} \adp \right\}$$

with

$$\omvp = \sqrt{\vp^2 + m^2}$$

\pause
we want to calculate the \alert{2-point function}
% XXX check term

\pause
$$\phixy$$

\pause
for \alert{purely spatial} separations $\vx - \vy = \vr, x^0 - y^0 = 0$.

\end{frame}


\begin{frame}
Plugging in the fields and using $\com{\ap}{\adpp} = (2\pi)^3 \delta(\vp - \vpp)$ we get:

\pause
$$\phixy = \frac{-i}{2(2\pi)^2 r} \intii \frac{p e^{ipr}}{\sqrtpm} dp$$

\pause
(See end of video for details.)

\end{frame}



\begin{frame}
The only step left is to evaluate the integral

$$\int_{-\infty}^{\infty} dp \integrand$$

\pause
Problem: \alert{This integral does not converge!} (Neither in Lebesgue's
nor Riemann's sense.)
% XXX the oscillations do not decay at high momenta
\end{frame}


\begin{frame}
Let's consider the integrand

$$\integrand$$

as a function of a \alert{complex} variable $p$.

\end{frame}


\begin{frame}
Actually, let's first look at:

$$\envelope$$

\pause
No surprises on the real line:

\pause
$$\envelope \ \rightarrow \ 1 \ \textrm{ for } p \rightarrow +\infty,$$

$$\envelope \ \rightarrow \ -1 \ \textrm{ for } p \rightarrow -\infty.$$

\end{frame}

% animate envelope on the real line, varying m
%: animate(3, sub { ['--envelope --z0 -10 --z1 10 --m 1', '', $im_env] });

%: animate(10, sub {
%:     my $m = interpol_xaby(5, 0.1, 0.1, 0.1, 1, 0.2, 3, 1, $_[0]);
%:     [sprintf('--envelope --z0 -10 --z1 10 --m %g', $m),
%:      sprintf(qq{
%:          --pre-plot 'set label "varying the mass..." at 0.25,2 font "serif,20"'
%:          --pre-plot 'set label "m = %4.2g" at 0.25,1.5 font "serif,20"'}, $m),
%:      $im_env]
%: });


\begin{frame}
It gets more interesting for complex $p$:

$$\envelope$$

\begin{itemize}

\pause
\item For $|p| \rightarrow \infty$ this goes to  a pure phase.
% XXX check if it is +/- 1

\pause
\item There are branch point \alert{singularities} at $p = im$ and $p = -im$.

\pause
\item The \alert{branch cut} lies along the imaginary axis towards $+i\infty$ and $-i\infty$.
(Due to the branch cut of the square root on the negative real axis.)
\end{itemize}
\end{frame}

% animate envelope on the real line, rotate to imaginary axis

% animate to show the branch cut

%: seq_name('branch-cut');
%: animate(20, sub {
%:     my $y = interpol_xaby(4, 0.1, 0.1, 0.1, 0, 0, 2, 2, $_[0]);
%:     my $preplot = '';
%:     my $im = '';
%:     if ($y >= 1.0) {
%:         $preplot .= q{ --pre-plot 'set grid x2tics ; set x2tics (0.5) format "" scale 0'};
%:     }
%:     if ($y > 1.2) {
%:         $preplot .= q{ --pre-plot 'set label "branch cut" at 0.5,2 center font "serif,20"'};
%:     }
%:     if ($y > 1.4) {
%:         $preplot .= q{ --pre-plot 'set arrow from 0.45,1.5 to 0.49,1.5 head'};
%:         $preplot .= q{ --pre-plot 'set arrow from 0.55,1.5 to 0.51,1.5 head'};
%:         $im .= ' label-branch-cut-neg.png -geometry +280+125 -composite';
%:         $im .= ' label-branch-cut-pos.png -geometry +570+125 -composite';
%:     }
%:     [sprintf('--envelope --z0 -10,%g --z1 10,%g --m 1', $y, $y),
%:      $preplot, $im_env.$im]
%: });

% XXX blink branch cut
% XXX label the window into the complex plane

\begin{frame}
Including the exponential we get

$$\integrand$$

which is

\begin{itemize}
\pause
\item \alert{oscillating} along the real axis,

\pause
\item \alert{exponentially damped} in the upper half plane.
\end{itemize}
\end{frame}

% animate integrand on the real line, rotating to vertical segments to show damping

%: animate(3, sub { ['--integrand --z0 -10 --z1 10 --m 1 --r 2', '', $im_igd] });

%: animate(12, sub {
%:     my $r = interpol_xaby(5, 0.1, 0.1, 0.1, 2, 0.5, 10, 2,$_[0]);
%:     [sprintf('--integrand --z0 -10 --z1 10 --m 1 --r %.3g', $r),
%:      sprintf(qq{
%:          --pre-plot 'set label "varying r..." at 0.25,2 font "serif,20"'
%:          --pre-plot 'set label "r = %4.2g" at 0.25,1.5 font "serif,20"'}, $r),
%:      $im_igd]
%: });

%: animate(10, sub {
%:     my $y = interpol_xaby(2, 0.1, 0.1, 0.1, 0, 2, 2, 0, $_[0]);
%:     my $preplot = ($y > 1.2) ? 'set label "branch cut" at 0.5,2 center font "serif,20"' : '';
%:     [sprintf('--integrand --z0 -10,%.3g --z1 10,%.3g --m 1', $y, $y),
%:      "--pre-plot '$preplot'", $im_igd]
%: });

%: seq_name('rotate-1');
%: animate(8, sub {
%:     my $t = interpol_xaby(1, 0.1, 0.2, 0.2, 0, 0, 1, 1, $_[0]);
%:     my @z0 = interpol_complex(-10,0, 0.01,0, $t);
%:     my @z1 = interpol_complex(+10,0, 0.01,2, $t);
%:     [sprintf('--integrand --z0 %.3g,%.3g --z1 %.3g,%.3g --m 1 --r 2', @z0, @z1),
%:      '', $im_igd]
%: });
%: seq_name('rotate-2');
%: animate(16, sub {
%:     my $t = interpol_xaby(2, 0.1, 0.1, 0.1, 0, 1, 1, 0, $_[0]);
%:     my @z0 = interpol_complex(0.01,0, 8,0, $t);
%:     my @z1 = interpol_complex(0.01,2, 8,2, $t);
%:     [sprintf('--integrand --z0 %.3g,%.3g --z1 %.3g,%.3g --m 1 --r 2', @z0, @z1),
%:      '', $im_igd]
%: });
%: seq_name('rotate-3');
%: animate(8, sub {
%:     my $t = interpol_xaby(1, 0.1, 0.2, 0.2, 1, 1, 0, 0, $_[0]);
%:     my @z0 = interpol_complex(-10,0, 0.01,0, $t);
%:     my @z1 = interpol_complex(+10,0, 0.01,2, $t);
%:     [sprintf('--integrand --z0 %.3g,%.3g --z1 %.3g,%.3g --m 1 --r 2', @z0, @z1),
%:      '', $im_igd]
%: });

% XXX introduce numerical integration

\begin{frame}
Let's do some numerical integration!
\end{frame}


\begin{frame}
We try a sharp cutoff at $p = \pm \Lambda$:

$$\int_{-\Lambda}^{+\Lambda} dp \integrand$$

% XXX move down
It looks like this as a function of $r$:
\end{frame}

% show integral, vary Lambda, vary m(?)

%: $opts = '--n 250 --z0 0.1 --z1 5 --m 1';
%: animate(3, sub {
%:     [$opts.' --Pr 45 --Pi 0 --d 0', '', $im_int]
%: });

%: animate(20, sub {
%:     my $Pr = interpol_xaby(5, 0.1, 0.1, 0.1, 45, 25, 60, 45, $_[0]);
%:     [sprintf($opts.' --Pr %.3g --Pi 0 --d 0', $Pr),
%:      sprintf(qq{
%:          --pre-plot 'set label "varying the cutoff..." at 5,8 font "serif,20"'
%:          --pre-plot 'set label "cutoff = %4.2g" at 5,5 font "serif,20"'}, $Pr),
%:      $im_int]
%: });

% XXX label contour windows


\begin{frame}
We see a function with:

\begin{itemize}
\pause
\item strong \alert{oscillations} at the cutoff momentum,

\pause
\item \alert{average value} falling \alert{exponentially} with $r$.
\end{itemize}

\pause
By deforming the integration contour we can show that indeed \alert{only}
the cutoff momentum contributes to the oscillations.
\end{frame}


\begin{frame}
Witness the miracle of \alert{Cauchy's theorem}!
% XXX look up
\end{frame}

% animate the M contour

%: animate(3, sub { [$opts.' --Pr 45 --Pi 0 --d 0', '', $im_int] });

%: animate(10, sub {
%:     my $t = interpol_xaby(1, 0.1, 0.1, 0.1, 0, 45, 0, 45, $_[0]);
%:     my $preplot = q{--pre-plot 'set label "pushing the contour..." at 5,8 font "serif,20"'};
%:     if ($_[0] > 0.1) {
%:         $preplot .= q{ --pre-plot 'set arrow from 1.9,6.8 to 1,5 head'};
%:         $preplot .= q{ --pre-plot 'set label "no change" at 2,7'};
%:     }
%:     [sprintf($opts.' --Pr 45 --Pi %.3g --d 0', $t),
%:      $preplot, $im_int]
%: });

%: animate(10, sub {
%:     my $Pr = interpol_xaby(3, 0.1, 0.1, 0.1, 45, 25, 60, 45, $_[0]);
%:     [sprintf($opts.' --Pr %.3g --Pi 45 --d 0', $Pr),
%:      sprintf(qq{
%:          --pre-plot 'set label "varying the cutoff..." at 5,8 font "serif,20"'
%:          --pre-plot 'set label "cutoff = %4.2g" at 5,5 font "serif,20"'}, $Pr),
%:      $im_int]
%: });

% XXX observations about parts of the contour
% Parts pushed high into the upper half plane become negligible.
% XXX justification of contour change (distributional character of the fields)
% Intuitively it is clear that the oscillations are an artifact
% of the sharp cutoff.
%
% The field operators are actually distributions which need to be smeared
% by test functions. Any smooth test function will effectively suppress 
% momenta above a certain scale $\Lambda$. We can always push the contour beyond $\Lambda$
% to make the "vertical" parts of the contour negligible. 

%: animate(10, sub {
%:     my $t = interpol_xaby(2, 0.1, 0.1, 0.1, 0, 0.1, 1.0, 1.0, $_[0]);
%:     [sprintf($opts.' --Pr 45 --Pi 45 --d %.3g', $t),
%:      sprintf(qq{
%:          --pre-plot 'set label "moving the endpoints..." at 5,8 font "serif,20"'}),
%:      $im_int]
%: });

% The non-oscillatory part of the integral is dominated by contributions
% from the U-shaped part of the contour close to the singularity.
% For r >> 1/m we can find an analytical approximation:
% XXX approximation for r >> 1/m
% XXX modified Bessel function as exact solution

%: seq_name('approx');
%: animate(10, sub {
%:     my $t = interpol_xaby(1, 0.3, 0.1, 0.5, 15, 0.1, 0.1, 0.1, $_[0]);
%:     [sprintf($opts.' --Pr 45 --Pi 45 --d 1'),
%:      sprintf(' --yrange %.2g:%.2g', -$t, $t).
%:      q{ --pre-plot 'm = 1'
%:         --append-plot 'sqrt(2*pi*m/x)*exp(-m*x) with lines lc rgb "black" lt 3' },
%:      $im_int]
%: });

%%: animate(5, sub {
%%:     my $t = interpol_xaby(1, 0.1, 0.1, 0.1, 1.0, 1.0, 1.0, 2.0, $_[0]);
%%:     [sprintf($opts.' --Pr 45 --Pi 45 --d %.3g', $t),
%%:      sprintf(qq{
%%:          --pre-plot 'set label "moving the endpoints..." at 5,8 font "serif,20"'}),
%%:      $im_int]
%%: });

%%: animate(15, sub {
%%:     my $t = interpol_xaby(4, 0.1, 0.1, 0.1, 2.0, 3.0, 2.8, 2.0, $_[0]);
%%:     [sprintf($opts.' --Pr 45 --Pi 45 --d %.3g', $t),
%%:      sprintf(qq{
%%:          --pre-plot 'set label "moving the endpoints..." at 5,8 font "serif,20"'}),
%%:      $im_int]
%%: });


\begin{frame}
\frametitle{Software Credits}

Numerical integration: GNU Scientific Library

Plotting: gnuplot

Presentation: \TeX + \LaTeX + Beamer, ImageMagick, avconv
\end{frame}


% XXX link to github code

% XXX details of integral equations
% XXX details of analytic approximation
% XXX proof that integral does not converge

\end{document}
